import{b2 as D,g as B,o as L,h as d,i as e,d as r,w as n,aE as N,c as C,e as f,E as p,aR as k,f as m,bi as A,b as i,t as a,l as w,F as O,j as q,u as E,G as S}from"./vendor-CyP8QNv9.js";import"./request-DTHdL8ze.js";import{_ as F}from"./index-DG4bgh5S.js";const R={name:"OrderDetail",components:{ArrowLeft:D},setup(){const T=E(),s=S(),l=B(!1),t=B({}),x=async()=>{l.value=!0;try{t.value={id:T.params.id,orderNumber:"ORD202403150001",status:"completed",createTime:"2024-03-15 12:30:00",completedTime:"2024-03-15 13:00:00",windowName:"特色炒菜",totalAmount:45,discount:5,mealType:"dine_in",reservedTime:"2024-03-15 12:45:00",paymentMethod:"balance",remark:"不要太辣",dishes:[{id:1,name:"宫保鸡丁",price:15,quantity:2,image_url:"https://example.com/dish1.jpg"},{id:2,name:"麻婆豆腐",price:15,quantity:1,image_url:"https://example.com/dish2.jpg"}]}}catch(o){console.error("获取订单详情失败:",o),p.error("获取订单详情失败")}finally{l.value=!1}},M=o=>({pending:"待处理",processing:"处理中",completed:"已完成",cancelled:"已取消"})[o]||o,v=o=>({pending:"warning",processing:"primary",completed:"success",cancelled:"info"})[o]||"",h=o=>({dine_in:"堂食",take_out:"打包"})[o]||o,_=o=>({balance:"余额支付",wechat:"微信支付",alipay:"支付宝"})[o]||o,g=o=>{s.push(`/student/dishes/${o}`)},u=async()=>{try{await k.confirm("确��要取消这个订单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),p.success("订单已取消"),s.back()}catch(o){o!=="cancel"&&(console.error("取消订单失败:",o),p.error("取消订单失败"))}},y=async()=>{try{await k.confirm("是否将订单中的菜品重新加入购物车？","再来一单",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}),l.value=!0,await new Promise(c=>setTimeout(c,500)),p.success({message:"已将菜品添加到购物车",duration:2e3}),await k.confirm("菜品已添加到购物车，是否立即前往购物车？","提示",{confirmButtonText:"前往购物车",cancelButtonText:"继续浏览",type:"success"}).catch(()=>!1)&&s.push("/student/cart")}catch(o){o!=="cancel"&&(console.error("再来一单失败:",o),p.error("操作失败，请重试"))}finally{l.value=!1}},b=()=>{s.back()};return L(()=>{x()}),{order:t,loading:l,getStatusLabel:M,getStatusType:v,getMealTypeLabel:h,getPaymentMethodLabel:_,viewDishDetail:g,cancelOrder:u,reorder:y,goBack:b}}},V={class:"order-detail"},j={class:"back-button"},P={class:"back-content"},z={class:"detail-content"},G={class:"status-header"},I={class:"order-info"},H={class:"order-number"},J={class:"order-time"},K={class:"time-item"},Q={class:"value"},U={key:0,class:"time-item"},W={class:"value"},X={class:"card-header"},Y={class:"window-name"},Z={class:"dishes-list"},$={class:"dish-info"},ee={class:"dish-name"},se={class:"dish-meta"},te={class:"dish-price"},oe={class:"dish-quantity"},ae={class:"dish-subtotal"},ne={class:"price-summary"},re={class:"price-item"},ie={class:"price-item"},le={class:"discount"},ce={class:"price-item total"},de={class:"final-price"},me={class:"info-list"},_e={class:"info-item"},ue={class:"value"},pe={class:"info-item"},fe={class:"value"},ve={class:"info-item"},he={class:"value"},ge={key:0,class:"info-item"},ye={class:"value"},be={class:"action-buttons"};function ke(T,s,l,t,x,M){const v=m("ArrowLeft"),h=m("el-icon"),_=m("el-button"),g=m("el-tag"),u=m("el-card"),y=m("el-image"),b=A("loading");return i(),d("div",V,[e("div",j,[r(_,{onClick:t.goBack,class:"custom-back-btn",link:""},{default:n(()=>[e("div",P,[r(h,{class:"back-icon"},{default:n(()=>[r(v)]),_:1}),s[0]||(s[0]=e("span",{class:"back-text"},"返回上一页",-1))])]),_:1},8,["onClick"])]),N((i(),d("div",z,[r(u,{class:"status-card"},{default:n(()=>[e("div",G,[e("div",I,[e("h2",H,"订单号："+a(t.order.orderNumber),1),r(g,{type:t.getStatusType(t.order.status),class:"status-tag",size:"large"},{default:n(()=>[w(a(t.getStatusLabel(t.order.status)),1)]),_:1},8,["type"])]),e("div",J,[e("div",K,[s[1]||(s[1]=e("span",{class:"label"},"下单时间：",-1)),e("span",Q,a(t.order.createTime),1)]),t.order.completedTime?(i(),d("div",U,[s[2]||(s[2]=e("span",{class:"label"},"完成时间：",-1)),e("span",W,a(t.order.completedTime),1)])):f("",!0)])])]),_:1}),r(u,{class:"dishes-card"},{header:n(()=>[e("div",X,[s[3]||(s[3]=e("h3",null,"菜品详情",-1)),e("span",Y,a(t.order.windowName),1)])]),default:n(()=>[e("div",Z,[(i(!0),d(O,null,q(t.order.dishes,o=>(i(),d("div",{key:o.id,class:"dish-item"},[r(y,{src:o.image_url,alt:o.name,class:"dish-image",onClick:c=>t.viewDishDetail(o.id)},{error:n(()=>s[4]||(s[4]=[e("div",{class:"image-placeholder"},"暂无图片",-1)])),_:2},1032,["src","alt","onClick"]),e("div",$,[e("h4",ee,a(o.name),1),e("div",se,[e("span",te,"¥"+a(o.price),1),e("span",oe,"× "+a(o.quantity),1)])]),e("div",ae," ¥"+a((o.price*o.quantity).toFixed(2)),1)]))),128))]),e("div",ne,[e("div",re,[s[5]||(s[5]=e("span",null,"商品总额",-1)),e("span",null,"¥"+a(t.order.totalAmount),1)]),e("div",ie,[s[6]||(s[6]=e("span",null,"优惠金额",-1)),e("span",le,"-¥"+a(t.order.discount||0),1)]),e("div",ce,[s[7]||(s[7]=e("span",null,"实付金额",-1)),e("span",de,"¥"+a((t.order.totalAmount-(t.order.discount||0)).toFixed(2)),1)])])]),_:1}),r(u,{class:"order-info-card"},{header:n(()=>s[8]||(s[8]=[e("h3",null,"订单信息",-1)])),default:n(()=>[e("div",me,[e("div",_e,[s[9]||(s[9]=e("span",{class:"label"},"就餐方式：",-1)),e("span",ue,a(t.getMealTypeLabel(t.order.mealType)),1)]),e("div",pe,[s[10]||(s[10]=e("span",{class:"label"},"预定时间：",-1)),e("span",fe,a(t.order.reservedTime),1)]),e("div",ve,[s[11]||(s[11]=e("span",{class:"label"},"支付方式：",-1)),e("span",he,a(t.getPaymentMethodLabel(t.order.paymentMethod)),1)]),t.order.remark?(i(),d("div",ge,[s[12]||(s[12]=e("span",{class:"label"},"备注：",-1)),e("span",ye,a(t.order.remark),1)])):f("",!0)])]),_:1}),e("div",be,[t.order.status==="pending"?(i(),C(_,{key:0,type:"danger",onClick:t.cancelOrder},{default:n(()=>s[13]||(s[13]=[w(" 取消订单 ")])),_:1},8,["onClick"])):f("",!0),t.order.status==="completed"?(i(),C(_,{key:1,type:"primary",plain:"",onClick:t.reorder},{default:n(()=>s[14]||(s[14]=[w(" 再来一单 ")])),_:1},8,["onClick"])):f("",!0)])])),[[b,t.loading]])])}const Me=F(R,[["render",ke],["__scopeId","data-v-833de557"]]);export{Me as default};
